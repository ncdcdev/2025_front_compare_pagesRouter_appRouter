version: 1
frontend:
  phases:
    preBuild:
      commands:
        - yarn install
        # Amplify Gen2: バックエンドリソースをデプロイ（オプション）
        # 注意: 初回はAmplifyコンソールでアプリを接続する必要があります
        - |
          if [ -f "amplify/backend.ts" ]; then
            echo "Amplify Gen2 backend detected"
            # Gen2のバックエンドリソースがある場合の処理
            # npx ampx pipeline-deploy コマンドはAmplifyコンソールで自動実行されます
          fi
    build:
      commands:
        - yarn run build
  artifacts:
    baseDirectory: .next
    files:
      - '**/*'
  cache:
    paths:
      - node_modules/**/*
      - .next/cache/**/*
      - amplify_outputs.json

